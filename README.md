# Отгрузочные таблицы (Autostuffing)

Скрипт на Python для автоматической сборки отгрузочных таблиц по приложениям из папок со счетами (xlsx), с заполнением листа Total (номера счетов, ЭСД, GTD).

---

## Быстрый старт

```bash
git clone https://github.com/YOUR_USERNAME/autostuffing.git
cd autostuffing
pip install -r requirements.txt
```

1. Положите в папку **`templates/`** один файл-шаблон отгрузочной таблицы (`.xlsx` или `.xlsm`).
2. Запустите скрипт и укажите рабочую папку (в ней — папки со счетами и/или подпапка `invoices/`):

```bash
python Autostuffing.py
```

Отгрузочные таблицы появятся в указанной папке — по одной на приложение.

---

## Что делает скрипт

- **Анализирует** папки со счетами в указанной директории (или в `invoices/`).
- **Определяет приложение** по имени папки — часть **после 3-й запятой** (например: `Компания, Отдел, 2024, MyApp, Доп` → приложение `MyApp`).
- **Группирует** папки по приложениям.
- **Для каждого приложения:**
  - копирует шаблон из `templates/` в рабочую папку;
  - копирует **первый лист** каждого xlsx-счёта в отгрузочную таблицу (с форматированием);
  - заполняет лист **Total**: номера счетов (колонка B), ЭСД (J), декларации GTD (O).

Имена файлов по умолчанию — **короткие** (без диапазона счетов), чтобы удобно работать с поездом. В конце работы скрипт предлагает:

- **1** — закрыть без изменения имён файлов;
- **2** — добавить в имена файлов диапазон счетов и количество (например: `(43;93;95-97;100) 6 pcs., LI, ...`).

После выбора скрипт ждёт нажатия Enter и завершается.

---

## Структура проекта

```
autostuffing/
├── Autostuffing.py      # основной скрипт
├── requirements.txt     # зависимости (openpyxl)
├── templates/           # сюда — один шаблон .xlsx или .xlsm
└── README.md
```

**Рабочая папка** (указывается при запуске):

- В ней лежат папки со счетами (или подпапка `invoices/` с такими папками).
- В папках со счетами: xlsx-счета, PDF (ЭСД, GTD).
- Сюда же сохраняются готовые отгрузочные таблицы.

Файл **`path.txt`** (создаётся в папке со скриптом) хранит последнюю рабочую папку — при следующем запуске можно нажать Enter и использовать её снова.

---

## Зависимости

- **Python 3.10+**
- **openpyxl** ≥ 3.1.0

При первом запуске скрипт сам установит зависимости из `requirements.txt` (если ещё не установлены).

---

## Настройки (в начале `Autostuffing.py`)

| Переменная           | Назначение                                      |
|----------------------|-------------------------------------------------|
| `INVOICE_SUBFOLDER`  | Подпапка со счетами (по умолчанию `invoices`)   |
| `TEMPLATE_SUBFOLDER` | Папка с шаблоном рядом со скриптом              |
| `LAST_PATH_FILE`     | Файл для сохранения последней рабочей папки     |

